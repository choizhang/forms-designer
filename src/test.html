<!DOCTYPE HTML>
<html>
<head>
    <title>Example</title>
    <style>
        #src > *
        {
        }
        #target, #src > img
        {
            border: thin solid black;
            padding: 2px;
            margin: 4px;
        }
        #target
        {
            height: 123px;
            width: 220px;
            text-align: center;
            display: table;
        }
        #target > p
        {
            display: table-cell;
            vertical-align: middle;
        }
        #target > img
        {
            margin: 1px;
        }
        img.dragged
        {
            background-color: lightgrey;
        }
    </style>
</head>
<body>
<div id="src" contenteditable="true">
    <img draggable="true" id="car1" src="http://ires.qiniudn.com/my/img/avatar-80-80.jpg" alt="car1" />
    <img draggable="true" id="car2" src="http://ires.qiniudn.com/my/img/avatar-80-80.jpg" alt="car2" />
    <img draggable="true" id="car3" src="http://ires.qiniudn.com/my/img/avatar-80-80.jpg" alt="car3" />

        <!--<table id="main" draggable="true"><tbody><tr class="firstRow"><th class="selectTdClass">​11<button id="abc">click</button></th><th class="selectTdClass">22</th><th class="selectTdClass">33</th></tr><tr><td><img src="text.png" id="editorComp_104" title="title" alt="文本域" style="width: 55px;height: 30px;text-align: center;line-height: 30px;font-size: 17px;" _src="text.png"></td><td><img src="text.png" id="editorComp_105" title="title" alt="文本域" style="width: 55px;height: 30px;text-align: center;line-height: 30px;font-size: 17px;" _src="text.png"></td><td><img src="text.png" id="editorComp_106" title="title" alt="文本域" style="width: 55px;height: 30px;text-align: center;line-height: 30px;font-size: 17px;" _src="text.png"></td></tr></tbody></table>-->


    <div id="main" class="component" draggable="true" id="editorComp_102"><button id="abc">click</button>文本域</div>


    发士大夫撒


    fas
    fasfa

    fa

    <!--<div id="main" draggable="true">-->
        <!--<button id="click">click</button>-->
        <!--<div>Hello world!</div>-->
        <!--<div>This is a paragraph</div>-->
    <!--</div>-->
</div>



<script type="text/javascript" src="third-party/jquery-1.10.2.js"></script>

<script>

    var mainDiv = document.getElementById("main");
//    var startNode = mainDiv.childNodes[1].childNodes[0];
//    var endNode = mainDiv.childNodes[3].childNodes[0];
//
//    var range = document.createRange();
//    range.setStart(startNode, 6); // 6 is the offset of "world" within "Hello world"
//    range.setEnd(endNode, 7); // 7 is the length of "this is"
//    var sel = window.getSelection();
//    sel.removeAllRanges();
//    sel.addRange(range);


    $('body').on('click', '#abc', function(e) {
        var el = $(this).closest('#main');

        requestAnimationFrame(function() {
            selectElementContents(el[0]);
        });
    })

    function selectElementContents(el) {
        var range = document.createRange();
//        range.selectNodeContents(el);
        range.selectNode(el);

        var sel = window.getSelection();
        sel.removeAllRanges();
        sel.addRange(range);

        console.log(range)
        console.log(sel)
    }




    var src = document.getElementById("src");
//    var target = document.getElementById("target");
    var msg = document.getElementById("msg");
    var draggedID;
//    target.ondragenter = handleDrag;
//    target.ondragover = handleDrag;
    function handleDrag(e) {
//        e.preventDefault();
    }
//    target.ondrop = function (e) {
////        var newElem = document.getElementById(draggedID).cloneNode(false);
////        target.innerHTML = "";
////        target.appendChild(newElem);
////        e.preventDefault();
//
//        console.log('drop')
//    }
    src.ondragstart = function (e) {
//        draggedID = e.target.id;
//        e.target.classList.add("dragged");

        console.log('aaa')
    }
    src.ondragend = function (e) {
//        var elems = document.querySelectorAll(".dragged");
//        for (var i = 0; i < elems.length; i++) {
//            elems[i].classList.remove("dragged");
//        }

        console.log('dd')
    }
</script>
</body>
</html>