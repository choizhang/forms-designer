# Daily Paper #

### 6.21 ###
1. 同黄奎,吴忠一起将后面要实现的功能进行整理并输出
2. 预研ueditor的多视图实现

### 6.22 ###
1. 将代码部署到github上进行每日迭代记录
2. 明白ueditor在dialog是如何进行数据交付的
3. 之前的table只能通过右键选择对齐方式,现在可以实现在顶部工具栏实现
4. 让实际操作区域能跟容器保持一定间距(目前只支持写死固定值,后期要支持编辑可配置)

### 6.23 ###
1. 将组件域功能进行分解输出
2. 组件拖拽(利用图片本身可以拖拽的功能)
3. 文本域和重复表可以生成,文本域可以做resize(resize是使用ueditor默认的功能,只能使用单标签来实现)
4. 遗留了一个未解决的bug,图片焦点问题

### 6.24 ###
1. 昨天遗留的焦点问题,看了源码并未找到好的解决方案(应该是在获取单节点的地方有问题).不过找到另外的方案,选择图片之后再按ESC去取消焦点,再点击其他地方即可
2. 表格支持修改边框的粗细,样式
3. 表格边框的是否显示移动到表格属性设置里面,将粗细设置为0
4. 表格增加保持现状布局, 自适应布局bugfix


### 6.27 ###
1. 加入树形结构
2. 添加组件的同时实现树形结构自动变化
3. 之前的组件拖动是使用的图片,但是复杂组件不可能只使用单标签的图片,研究其他dom的拖拽,支持度都不如img好(未找到结果)

### 6.28 ###
1. 今天继续研究组件拖拽问题.目前已经实现组件全选然后拖拽到新位置.
2. (todo1) 在ueditor里面拖拽是copy的方式,不是move的,还未找到在哪里修改
3. (todo2) 要梳理工具的方向,要同formtalk,infopath等差异

### 6.29 ###
1. 实现了重复表和文本域的可拖动
2. 实现树形结构和组件点击的互相关联

### 6.30 ###
1. 对通过ueditor编辑生成的html代码进行了兼容性测试(结论: ueditor生成的代码还需要二次转化,比如将一些编辑器里面的功能去掉,将一些公用的样式要提取到一个文件里面)
2. (todo1) 表格默认生成的时候是没有设置值得,最后样式会缩到一起,如果手动拖拽了就会生成值,需要对默认做吹
3. 下午team buiding

### 7.1 ###
1. 整理此项目的介绍ppt,完成6.28中的todo2
2. 组件在拖拽之后不能马上进行高宽调节,~~目前需要多次操作或通过输入其他内容后去调节~~,已经解决,将contentchange回调里的hideDragLine注释了,不知道会不会有其他影响
3. 域结构加入了右键菜单(todo: 将插件的信息存入域结构中)

### 7.4 ###
1. 组件和域结构编辑联动
2. 能在编辑区中插入域结构中的组件
3. 直接拖拽非table的组件有问题,这里暂时还是用table,table内部可以用真实组件
4. 在拖拽会生成不必要的br和空格,还不知如何解决

### 7.5 ###
1. 对代码进行梳理
2. 多个组件要放到公共域
3. 如果组件完全删除要放到垃圾箱
4. (todo)组件的名称编辑是只能在域结构中还是编辑区也可以

### 7.6 ###
1. 研究ribbon布局如何实现

### 7.7 -- 7.8 ###
项目组集体调休

### 7.11 ###
1. 实现ribbon布局

### 7.12 ###
1. 解决在多tab下的ribbon布局
2. 录制制作简单表单的视频
3. 给组件后面添加标志图标并观察兼容性
4. 域结构中的视图默认是关闭的(bug)
5. ~~组件高亮状态并没有选中(bug)~~, 保持高亮和拖拽独立
5. 表格布局中的组件在表格设置了边框样式的时候被影响了(bug)
6. (todo)颜色组件要重构
7. (todo)单元格布局组件频率高
8. (todo)单行单列的最小值要设置
9. (todo)去掉表格默认的br标签
10. (todo)表格的行列设置需要弹窗输入值

### 7.13 ###
1. 添加了一个自定义的模板
2. 如果模板中带有组件,自动生成相应的域结构,并能保持正确的后续操作
    组件值得处理策略:
    1. 如果模板该组件没有值,则将组件名+系统变量作为名字
    2. 如果模板有值,则将该值作为名字
3. 让自定义的组件到任一tab中的任一位置去

### 7.14 ###
1. 添加模板自动添加相应的域结构
2. 开会过进度
3. 重新整理feature list
4. 能够引入打印样式控制

### 7.15 ###
1. 实现如果添加字体配置和默认字体的设置
2. 讨论出系统未安装字体的显示方案
3. 下午V5的产品发布会

### 7.18 ###
1. 解决未安装字体的显示问题
2. 域结构显示的bugfix
3. 区分了组件的高亮态和拖拽态

### 7.19 ###
1. 安装jsp环境,跟后台jsp调通
2. 实现单个图片,多个图片,视频,音频的正确上传
3. 表格设置为居中后,在预览模式下失效
4. 本地保存成功的提示信息隐藏,更换位置目前代码不好改

### 7.20 ###
1. 表格在修改边框样式后,再增加行列,样式不对
2. 在表格固定宽度后,如果插入重复表会撑开.这个没有办法,已经将重复表默认到最小了.用户如果要插入重复表应该预留大一些
3. 单元格添加了padding设置
4. 插入表格可以设置表格的宽度或者单元格的宽度
5. 点击选择按钮的时候,相应的域结构并没有高亮
6. 选中状态下,再点击组件内部,要更改为高亮态
7. 查看轻表单的项目代码,并评估"一键插入全部组件"的工作量.结论是,目前主要还是在pc表单设计器这块,有业余时间研究轻表单的代码.

### 7.21 ###
1. 插入背景图片的支持
2. 用户本地未安装字体帮助文档说明(由于win和mac的安装字体完全不同,情况太复杂.所以这里只考虑win,然而我们需要的字体windows都自带了)
3. 分页符在打印视图和预览视图的友好支持
4. 表格拖拽增加宽高流畅度解决,升级ueditor导致的


### 7.22 ###
1. 图片添加可以拖拽高宽的效果
2. 页眉页脚效果(20%)
3. (todo)表格设置背景色,然后再右键点击bug,不太好解决

### 7.25 ###
1. 页眉页脚插入删除,在插入分页符自动增加.
2. 页眉页脚简易的模板模块设计
3. 页眉页脚在多视图中统一设置
4. 表单具体单元格权限设计(根据权限来显示隐藏)(20%)

### 7.26 ###
1. 页眉页脚在多视图中统一设置(目前各个tab是独立的,而且一旦联动修改了,就不能单独改了),目前暂时单独设置
2. 表单具体单元格权限设计(根据权限来显示隐藏)
3. (todo)用户编辑过的页眉页脚可以保存到系统方便下次使用(需要用户登录系统,后台支持)

### 7.27 ###
1. 跟辛裴讨论cmp history模块的处理ajax弹窗的方法,将之前的demo文档添加了功能说明
2. 跟黄奎勾兑表单设计器导出数据格式（黄奎出差，下周回，不过拿到了之前的格式，先研究下）
3. 对表格右键菜单内容做优化(目前右键承载功能太多,且很多低频功能)
4. 优化罗宾布局，实现类似百度doc的UI结构（60%）

### 7.28 ###
1. 完成罗宾布局的UI结构(完成了表格tab,后续其他tab再跟UI配合)
2. 将系统中的域结构生成json格式的
3. 研究多视图中，html如何导出
4. 视图的权限设计

### 7.29 ###
1. 表格行高/列宽设置（最小值，固定值）
2. 域结构点击x关闭,视图也要删除.视图在域结构没有删除功能
3. dialog加载体验优化(是用iframe外联css的方式,在本地有css闪烁的情况,但是在外网络环境此bug不存在)

### 8.1 ###
1. 视图中间距调整优化(视图的间距要不要,打印可以配置)
2. 在拖拽或者聚焦失焦的时候，会乱入无宽度空格（\u200B, &#8203;），尝试了修复措施，但是时候修复对体验影响很糟糕，研究很久并未找到很好的解决方案
3. 研究组件本身的样式修改模块的设计(50%)
4. 取消视图tab中的数字标志,很难维护

### 8.2 ###
1. 继续尝试处理无宽度空格问题
2. 跟黄奎讨论下目前工具发展的进度和一些体验优化

### 8.3 ###
1. 开通204服务器的权限并了解之前的处理方式
2. 跟戴毅讨论之前infopath导出所用到的信息并制定本系统交互的数据格式
3. 视图中的组件通过各种原因删除了,域结构中提供一个刷新按钮可以校对
4. 修改权限多选的bug
5. 修复表格嵌套导致重复表均分不能用和计算错误的bug(表格在均分会导致整体有偏差,这是无法取整的问题,没法解决)

### 8.4 ###
1. 将域结构导出所需格式
2. 将视图html导出
3. 将rgb变为16进制以供input[color]用户编辑过的页眉页脚可以保存到系统方便下次使用
4. 根据昨天的讨论修改域结构和视图组件的交互方式

### 8.5 ###
1. 实现只能删除本次的新增域
2. 域结构的删除改用自己实现的显示隐藏方法
3. 导出结构的实现和导入的结构的规划


### 8.6 ###
1. 删除按钮未将视图中删除的bug
2. 整理最近联调的wiki文档
3. 实现导入结构并初始化系统(mock data)
4. 多视图的结构确定和初始化
5. 使用标准的方法来执行editor的回调初始化

### 8.8 ###
1. 将域结构的刷新功能添加在特定事件的回调中以提升体验(插入,contentchange)
2. 取消ueditor本身的底部提示功能
3. 将域结构和组件样式设置放到一个tabset里
4. 域结构的视图概念取消了,我之前对视图权限的处理方式也做相应调整
5. 组件的设置支持多种类型(目前是视图,文本)

### 8.9 ###
1. 修复选择多个单元格的时候再选择设置,会将选择高亮的背景色默认为单元格背景色的bug
2. 将代码给代毅部署到测试服务器上
3. 插入表格,要控制表格可设置总宽度(表格,单元格)
4. 增加组件的权限设置

### 8.10 ###
1. 整个页面的布局间距设置
2. 取消了增加视图让标志发生变化,因为这会导致zTree的id跟组件里并不一致
3. 组件的高宽拖拽在设置padding值之后计算错误,高度取消了10以内不能拖动的限制
4. 产品发布了beta版,跟吴总体验确定下一步工作计划

### 8.11 ###
1. 视图区横向允许有滚动条
2. windows安装infopath,dreamwave等工具
3. 组件(文本域)设置中添加布局
4. 统一颜色组件,支持rgb(60%)
7. 增加组件(文本域)公共设置功能

### 8.12 ###
1. 松坪沟游玩

### 8.15 ###
1. 研究复制,剪切,粘贴
2. 统一颜色组件,支持rgb
3. 和黄奎讨论CAP+的发展方向(未来还有一部分重心要转入到如何将页面数据渲染到不同的设备上面)

### 8.16 ###
1. 重复表支持页脚
2. 域结构可以平级拖动
3. 将表格和单元格的对齐方式搬到工具栏
4. 将表格和单元格的属性设置搬到工具栏
5. 替换文本域和重复表的图标

todo:

1. 在重复表中新插入文本域,域结构能正常嵌套
2. 使用本地存储来存储用户编辑的模板(主要是要打通本地存储的逻辑,后面肯定能用到)
5. 默认的间距设置为4个值
6. 开启剪切粘贴

将之前CAP的所有组件迁移到系统中(工作量太大,目前主要还是只替换下infopath就ok)

后端提供模板保存的接口(或者使用本地存储?)

组件样式设置:

1. 组件的高宽通过拖拽的方式生成
2. 颜色,字体大小


页脚现在支持度不好,先暂时隐藏起来

bug:

单元格设置背景后,点击右键,结果背景颜色样式去掉了
给单元格设置了padding后,拖拽组件去其他单元格,结果padding设置没有了(如果单元格中一直有br就不会有这个bug)(是不是js发现单元格没有内容做了清理操作)

权限规则:

1. 如果对非整行做权限设计,则将操作列的内容隐藏但占位

2. 如果是对整行做权限设计,则将整行内容隐藏不占位

3. 选择整列的时候,内容隐藏但占位(因为不占位不好实现,而且从需求出发占位比较好)

使用场景: 组件,视图,多个单元格

重复表:

重复表最开始要确定好文本域的数量,不然后期添加域结构有问题,而且也不统一


feildName: 'feild0001'
feildTitle: '姓名'(在域结构中显示的名字)
label: '姓名'

在域结构中不能同名,需要给用户提示

删除逻辑:

1. 视图中的组件始终可以被删除了(如果删除完了就会在前面出现标志)
2. 域结构中只提供本次增加的可以删除(不然会累积太多)(直接隐藏此结构)
3. 域结构中不能删除之前添加的

插入一样的: 就只有label可以修改,如果修改了feildTitle,那么就是全部都改了

导出逻辑:

一份原始代码
一份要去除拖拽句柄,隐藏的页眉页脚,用于拖拽的table布局





